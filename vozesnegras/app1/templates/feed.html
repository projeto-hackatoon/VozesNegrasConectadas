{% extends 'base.html' %}

{% block content %}
<h2>Feed da Comunidade</h2>
<p>Espaço de visibilidade e fortalecimento[cite: 12, 16].</p>

{% for post in posts %}
<div class="card">
    <div class="card-header">
        <span>Por: <strong>{{ post.autor.username }}</strong></span>
        <span style="background: #eee; padding: 2px 8px; border-radius: 10px;">{{ post.categoria.nome }}</span>
    </div>
    
    <h3 class="card-title">{{ post.titulo }}</h3>
    <p>{{ post.conteudo }}</p>

    {% if post.midia %}
        {% if '.mp4' in post.midia.url %}
            <video controls><source src="{{ post.midia.url }}" type="video/mp4"></video>
        {% else %}
            <img src="{{ post.midia.url }}" alt="Conteúdo da postagem">
        {% endif %}
    {% endif %}

    <div class="acoes">
        <strong>{{ post.total_votos }} Pontos de Impacto</strong>
        <a href="{% url 'votar' post.id 'UP' %}" class="btn-voto up">Apoiar (UP)</a>
        <a href="{% url 'votar' post.id 'DOWN' %}" class="btn-voto down">Não Apoiar</a>
    </div>
</div>
{% empty %}
    <p>Ainda não há vozes aprovadas. Seja o primeiro a falar!</p>
{% endfor %}
{% endblock %}